
este post es la segunda parte de este post: <a href="http://marianoguerra.blogspot.com/2009/03/webservices-rest-en-java-con-jetty-y.html">http://marianoguerra.blogspot.com/2009/03/webservices-rest-en-java-con-jetty-y.html</a><br/><br/><br/>Para tener webservices REST como la gente necesitamos poder transformar nuestros objetos a una representacion que pueda ser entendida por muchos lenguajes y de vuelta de esa representacion a objetos java, para ello vamos a crear los objetos de nuetro modelo y los vamos  anotar para poder serializar/desserializar a XML y JSON, yo particularmente prefiero JSON porque es mas simple, legible y interactua muy bien con javascript, que suele ser el otro extremo de cualquier aplicacion web, pero no importa ya que de la forma que voy a mostrar nos permite hacer los dos por el precio de uno.<br/><br/>Para ello creamos primero el paquete model dentro de nuestro proyecto, en mi caso addressbook.model y adentro creamos dos clases, AddressBook y AddressBookEntry<br/><br/>para poder usar las anotaciones de serializacion agregamos los siguientes jars<br/><br/><a href="http://download.java.net/maven/1/javax.xml.bind/jars/jaxb-api-2.1.jar">jaxb-api-2.1.jar</a><br/><a href="http://download.java.net/maven/1/com.sun.xml.bind/jars/jaxb-impl-2.1.jar">jaxb-impl-2.1.jar</a><br/><br/>para poder serializar a JSON agregamos el siguiente jar<br/><br/><a href="http://repository.codehaus.org/org/codehaus/jettison/jettison/1.0.1/jettison-1.0.1.jar">jettison-1.0.1.jar</a><br/><br/>para buscar versiones mas nuevas podes ir a <a href="http://download.java.net/maven/1/javax.xml.bind/jars">http://download.java.net/maven/1/javax.xml.bind/jars</a>/ y <a href="http://repository.codehaus.org/org/codehaus/jettison/jettison/">http://repository.codehaus.org/org/codehaus/jettison/jettison/</a> respectivamente.<br/><br/>ahora creamos la clase AddressBookEntry que simplemente va a contener los siguientes atributos privados, todos strings:<br/><br/><ul><li>firstName</li><li>lastName</li><li>address</li><li>homePhone</li><li>workPhone</li><li>cellPhone</li></ul>creamos los getters/setters y dos constructores, uno sin argumentos que inicializa los valores por default y uno con todos los parametros.<br/><br/>ahora llega la hora de decorar la clase para poder serializarla, el resultado es el siguiente:<br/><br/><br/><div class="highlight"><pre><span class="c">/*</span><br/><span class="c"> * To change this template, choose Tools | Templates</span><br/><span class="c"> * and open the template in the editor.</span><br/><span class="c"> */</span><br/><br/><span class="k">package</span> <span class="n">addressbook</span><span class="o">.</span><span class="na">model</span><span class="o">;</span><br/><br/><span class="k">import</span> <span class="nn">java.io.Serializable</span><span class="o">;</span><br/><span class="k">import</span> <span class="nn">javax.xml.bind.annotation.XmlAccessType</span><span class="o">;</span><br/><span class="k">import</span> <span class="nn">javax.xml.bind.annotation.XmlAccessorType</span><span class="o">;</span><br/><span class="k">import</span> <span class="nn">javax.xml.bind.annotation.XmlRootElement</span><span class="o">;</span><br/><br/><span class="c">/**</span><br/><span class="c"> *</span><br/><span class="c"> * @author mariano</span><br/><span class="c"> */</span><br/><span class="nd">@XmlAccessorType</span><span class="o">(</span><span class="n">XmlAccessType</span><span class="o">.</span><span class="na">FIELD</span><span class="o">)</span><br/><span class="nd">@XmlRootElement</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"addressBookEntity"</span><span class="o">)</span><br/><span class="k">public</span> <span class="k">class</span> <span class="nc">AddressBookEntry</span> <span class="k">implements</span> <span class="n">Serializable</span><span class="o">{</span><br/><span class="k">private</span> <span class="n">String</span> <span class="n">firstName</span><span class="o">;</span><br/><span class="k">private</span> <span class="n">String</span> <span class="n">lastName</span><span class="o">;</span><br/><span class="k">private</span> <span class="n">String</span> <span class="n">address</span><span class="o">;</span><br/><span class="k">private</span> <span class="n">String</span> <span class="n">homePhone</span><span class="o">;</span><br/><span class="k">private</span> <span class="n">String</span> <span class="n">workPhone</span><span class="o">;</span><br/><span class="k">private</span> <span class="n">String</span> <span class="n">cellPhone</span><span class="o">;</span><br/><br/><span class="k">public</span> <span class="nf">AddressBookEntry</span><span class="o">()</span> <span class="o">{</span><br/><span class="o">}</span><br/><br/><span class="k">public</span> <span class="nf">AddressBookEntry</span><span class="o">(</span><span class="n">String</span> <span class="n">firstName</span><span class="o">,</span> <span class="n">String</span> <span class="n">LastName</span><span class="o">,</span> <span class="n">String</span> <span class="n">address</span><span class="o">,</span> <span class="n">String</span> <span class="n">homePhone</span><span class="o">,</span> <span class="n">String</span> <span class="n">workPhone</span><span class="o">,</span> <span class="n">String</span> <span class="n">cellPhone</span><span class="o">)</span> <span class="o">{</span><br/><span class="k">this</span><span class="o">.</span><span class="na">firstName</span> <span class="o">=</span> <span class="n">firstName</span><span class="o">;</span><br/><span class="k">this</span><span class="o">.</span><span class="na">lastName</span> <span class="o">=</span> <span class="n">LastName</span><span class="o">;</span><br/><span class="k">this</span><span class="o">.</span><span class="na">address</span> <span class="o">=</span> <span class="n">address</span><span class="o">;</span><br/><span class="k">this</span><span class="o">.</span><span class="na">homePhone</span> <span class="o">=</span> <span class="n">homePhone</span><span class="o">;</span><br/><span class="k">this</span><span class="o">.</span><span class="na">workPhone</span> <span class="o">=</span> <span class="n">workPhone</span><span class="o">;</span><br/><span class="k">this</span><span class="o">.</span><span class="na">cellPhone</span> <span class="o">=</span> <span class="n">cellPhone</span><span class="o">;</span><br/><span class="o">}</span><br/><br/><span class="k">public</span> <span class="n">String</span> <span class="nf">getLastName</span><span class="o">()</span> <span class="o">{</span><br/><span class="k">return</span> <span class="n">lastName</span><span class="o">;</span><br/><span class="o">}</span><br/><br/><span class="k">public</span> <span class="kt">void</span> <span class="nf">setLastName</span><span class="o">(</span><span class="n">String</span> <span class="n">LastName</span><span class="o">)</span> <span class="o">{</span><br/><span class="k">this</span><span class="o">.</span><span class="na">lastName</span> <span class="o">=</span> <span class="n">LastName</span><span class="o">;</span><br/><span class="o">}</span><br/><br/><span class="k">public</span> <span class="n">String</span> <span class="nf">getAddress</span><span class="o">()</span> <span class="o">{</span><br/><span class="k">return</span> <span class="n">address</span><span class="o">;</span><br/><span class="o">}</span><br/><br/><span class="k">public</span> <span class="kt">void</span> <span class="nf">setAddress</span><span class="o">(</span><span class="n">String</span> <span class="n">address</span><span class="o">)</span> <span class="o">{</span><br/><span class="k">this</span><span class="o">.</span><span class="na">address</span> <span class="o">=</span> <span class="n">address</span><span class="o">;</span><br/><span class="o">}</span><br/><br/><span class="k">public</span> <span class="n">String</span> <span class="nf">getCellPhone</span><span class="o">()</span> <span class="o">{</span><br/><span class="k">return</span> <span class="n">cellPhone</span><span class="o">;</span><br/><span class="o">}</span><br/><br/><span class="k">public</span> <span class="kt">void</span> <span class="nf">setCellPhone</span><span class="o">(</span><span class="n">String</span> <span class="n">cellPhone</span><span class="o">)</span> <span class="o">{</span><br/><span class="k">this</span><span class="o">.</span><span class="na">cellPhone</span> <span class="o">=</span> <span class="n">cellPhone</span><span class="o">;</span><br/><span class="o">}</span><br/><br/><span class="k">public</span> <span class="n">String</span> <span class="nf">getFirstName</span><span class="o">()</span> <span class="o">{</span><br/><span class="k">return</span> <span class="n">firstName</span><span class="o">;</span><br/><span class="o">}</span><br/><br/><span class="k">public</span> <span class="kt">void</span> <span class="nf">setFirstName</span><span class="o">(</span><span class="n">String</span> <span class="n">firstName</span><span class="o">)</span> <span class="o">{</span><br/><span class="k">this</span><span class="o">.</span><span class="na">firstName</span> <span class="o">=</span> <span class="n">firstName</span><span class="o">;</span><br/><span class="o">}</span><br/><br/><span class="k">public</span> <span class="n">String</span> <span class="nf">getHomePhone</span><span class="o">()</span> <span class="o">{</span><br/><span class="k">return</span> <span class="n">homePhone</span><span class="o">;</span><br/><span class="o">}</span><br/><br/><span class="k">public</span> <span class="kt">void</span> <span class="nf">setHomePhone</span><span class="o">(</span><span class="n">String</span> <span class="n">homePhone</span><span class="o">)</span> <span class="o">{</span><br/><span class="k">this</span><span class="o">.</span><span class="na">homePhone</span> <span class="o">=</span> <span class="n">homePhone</span><span class="o">;</span><br/><span class="o">}</span><br/><br/><span class="k">public</span> <span class="n">String</span> <span class="nf">getWorkPhone</span><span class="o">()</span> <span class="o">{</span><br/><span class="k">return</span> <span class="n">workPhone</span><span class="o">;</span><br/><span class="o">}</span><br/><br/><span class="k">public</span> <span class="kt">void</span> <span class="nf">setWorkPhone</span><span class="o">(</span><span class="n">String</span> <span class="n">workPhone</span><span class="o">)</span> <span class="o">{</span><br/><span class="k">this</span><span class="o">.</span><span class="na">workPhone</span> <span class="o">=</span> <span class="n">workPhone</span><span class="o">;</span><br/><span class="o">}</span><br/><br/><br/><span class="o">}</span><br/></pre></div><br/><br/>si se fijan hay dos anotaciones nomas, uno que le dice el nombre de la entidad cuando la serialize y el otro le dice si debe buscar las anotaciones de los atributos en la definicion de los atributos o en los getters/setters.<br/><br/>programamos la clase que contiene muchos AddressBookEntry y la decoramos para poder serializarla:<br/><br/><div class="highlight"><pre><span class="c">/*</span><br/><span class="c"> * To change this template, choose Tools | Templates</span><br/><span class="c"> * and open the template in the editor.</span><br/><span class="c"> */</span><br/><br/><span class="k">package</span> <span class="n">addressbook</span><span class="o">.</span><span class="na">model</span><span class="o">;</span><br/><br/><span class="k">import</span> <span class="nn">java.util.Vector</span><span class="o">;</span><br/><span class="k">import</span> <span class="nn">javax.xml.bind.annotation.XmlAccessType</span><span class="o">;</span><br/><span class="k">import</span> <span class="nn">javax.xml.bind.annotation.XmlAccessorType</span><span class="o">;</span><br/><span class="k">import</span> <span class="nn">javax.xml.bind.annotation.XmlElement</span><span class="o">;</span><br/><span class="k">import</span> <span class="nn">javax.xml.bind.annotation.XmlRootElement</span><span class="o">;</span><br/><br/><span class="c">/**</span><br/><span class="c"> *</span><br/><span class="c"> * @author mariano</span><br/><span class="c"> */</span><br/><span class="nd">@XmlAccessorType</span><span class="o">(</span><span class="n">XmlAccessType</span><span class="o">.</span><span class="na">FIELD</span><span class="o">)</span><br/><span class="nd">@XmlRootElement</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"addressBook"</span><span class="o">)</span><br/><span class="k">public</span> <span class="k">class</span> <span class="nc">AddressBook</span> <span class="o">{</span><br/><span class="nd">@XmlElement</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"entry"</span><span class="o">)</span><br/><span class="k">private</span> <span class="n">Vector</span><span class="o">&lt;</span><span class="n">AddressBookEntry</span><span class="o">&gt;</span> <span class="n">entries</span><span class="o">;</span><br/><br/><span class="k">public</span> <span class="nf">AddressBook</span><span class="o">()</span> <span class="o">{</span><br/><span class="n">entries</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Vector</span><span class="o">&lt;</span><span class="n">AddressBookEntry</span><span class="o">&gt;();</span><br/><span class="o">}</span><br/><br/><span class="k">public</span> <span class="nf">AddressBook</span><span class="o">(</span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">AddressBookEntry</span><span class="o">&gt;</span> <span class="n">entries</span><span class="o">)</span> <span class="o">{</span><br/><span class="k">this</span><span class="o">.</span><span class="na">entries</span> <span class="o">=</span> <span class="n">entries</span><span class="o">;</span><br/><span class="o">}</span><br/><br/><span class="k">public</span> <span class="n">Vector</span><span class="o">&lt;</span><span class="n">AddressBookEntry</span><span class="o">&gt;</span> <span class="n">getEntries</span><span class="o">()</span> <span class="o">{</span><br/><span class="k">return</span> <span class="n">entries</span><span class="o">;</span><br/><span class="o">}</span><br/><br/><span class="k">public</span> <span class="kt">void</span> <span class="nf">setEntries</span><span class="o">(</span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">AddressBookEntry</span><span class="o">&gt;</span> <span class="n">entries</span><span class="o">)</span> <span class="o">{</span><br/><span class="k">this</span><span class="o">.</span><span class="na">entries</span> <span class="o">=</span> <span class="n">entries</span><span class="o">;</span><br/><span class="o">}</span><br/><br/><span class="k">public</span> <span class="kt">void</span> <span class="nf">addEntry</span><span class="o">(</span><span class="n">AddressBookEntry</span> <span class="n">entry</span><span class="o">)</span><br/><span class="o">{</span><br/><span class="n">entries</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">entry</span><span class="o">);</span><br/><span class="o">}</span><br/><br/><span class="k">public</span> <span class="kt">boolean</span> <span class="nf">removeEntry</span><span class="o">(</span><span class="n">AddressBookEntry</span> <span class="n">entry</span><span class="o">)</span><br/><span class="o">{</span><br/><span class="k">return</span> <span class="n">entries</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">entry</span><span class="o">);</span><br/><span class="o">}</span><br/><br/><span class="k">public</span> <span class="n">Vector</span><span class="o">&lt;</span><span class="n">AddressBookEntry</span><span class="o">&gt;</span> <span class="n">search</span><span class="o">(</span><span class="n">String</span> <span class="n">query</span><span class="o">)</span><br/><span class="o">{</span><br/><span class="n">Vector</span><span class="o">&lt;</span><span class="n">AddressBookEntry</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Vector</span><span class="o">&lt;</span><span class="n">AddressBookEntry</span><span class="o">&gt;();</span><br/><br/><span class="n">result</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">searchByFirstName</span><span class="o">(</span><span class="n">query</span><span class="o">));</span><br/><span class="n">result</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">searchByLastName</span><span class="o">(</span><span class="n">query</span><span class="o">));</span><br/><span class="k">return</span> <span class="n">result</span><span class="o">;</span><br/><span class="o">}</span><br/><br/><span class="k">public</span> <span class="n">Vector</span><span class="o">&lt;</span><span class="n">AddressBookEntry</span><span class="o">&gt;</span> <span class="n">searchByFirstName</span><span class="o">(</span><span class="n">String</span> <span class="n">query</span><span class="o">)</span><br/><span class="o">{</span><br/><span class="n">Vector</span><span class="o">&lt;</span><span class="n">AddressBookEntry</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Vector</span><span class="o">&lt;</span><span class="n">AddressBookEntry</span><span class="o">&gt;();</span><br/><span class="k">for</span><span class="o">(</span><span class="n">AddressBookEntry</span> <span class="nl">entry:</span> <span class="n">entries</span><span class="o">)</span><br/><span class="o">{</span><br/><span class="k">if</span><span class="o">(</span><span class="n">entry</span><span class="o">.</span><span class="na">getFirstName</span><span class="o">().</span><span class="na">indexOf</span><span class="o">(</span><span class="n">query</span><span class="o">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span><br/><span class="o">{</span><br/><span class="n">result</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">entry</span><span class="o">);</span><br/><span class="o">}</span><br/><span class="o">}</span><br/><br/><span class="k">return</span> <span class="n">result</span><span class="o">;</span><br/><span class="o">}</span><br/><br/><span class="k">public</span> <span class="n">Vector</span><span class="o">&lt;</span><span class="n">AddressBookEntry</span><span class="o">&gt;</span> <span class="n">searchByLastName</span><span class="o">(</span><span class="n">String</span> <span class="n">query</span><span class="o">)</span><br/><span class="o">{</span><br/><span class="n">Vector</span><span class="o">&lt;</span><span class="n">AddressBookEntry</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Vector</span><span class="o">&lt;</span><span class="n">AddressBookEntry</span><span class="o">&gt;();</span><br/><span class="k">for</span><span class="o">(</span><span class="n">AddressBookEntry</span> <span class="nl">entry:</span> <span class="n">entries</span><span class="o">)</span><br/><span class="o">{</span><br/><span class="k">if</span><span class="o">(</span><span class="n">entry</span><span class="o">.</span><span class="na">getLastName</span><span class="o">().</span><span class="na">indexOf</span><span class="o">(</span><span class="n">query</span><span class="o">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span><br/><span class="o">{</span><br/><span class="n">result</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">entry</span><span class="o">);</span><br/><span class="o">}</span><br/><span class="o">}</span><br/><br/><span class="k">return</span> <span class="n">result</span><span class="o">;</span><br/><span class="o">}</span><br/><span class="o">}</span><br/></pre></div><br/><br/>Lo unico que cambia con respecto al anterior es que a la coleccion le digo cual es el tag de cada elemento interno de la coleccion.<br/><br/>con este decorador<br/><br/><pre>    <span class="nd">@XmlElement</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"entry"</span><span class="o">)<br/><br/></span></pre>le agregue algunos metodos de busqueda que nos van a servir mientras no tengamos persistencia.<br/><br/>por ultimo modifique la clase que expone el webservice para que genere json y xml y cree un metodo temporal para llenar con datos el addressbook (hasta que haya persistencia).<br/><br/>aca esta el codigo de addressbook.ws.AddressBook:<br/><br/><div class="highlight"><pre><span class="c">/*</span><br/><span class="c"> * To change this template, choose Tools | Templates</span><br/><span class="c"> * and open the template in the editor.</span><br/><span class="c"> */</span><br/><br/><span class="k">package</span> <span class="n">addressbook</span><span class="o">.</span><span class="na">ws</span><span class="o">;</span><br/><br/><span class="k">import</span> <span class="nn">addressbook.model.AddressBookEntry</span><span class="o">;</span><br/><span class="k">import</span> <span class="nn">javax.ws.rs.GET</span><span class="o">;</span><br/><span class="k">import</span> <span class="nn">javax.ws.rs.Path</span><span class="o">;</span><br/><span class="k">import</span> <span class="nn">javax.ws.rs.PathParam</span><span class="o">;</span><br/><span class="k">import</span> <span class="nn">javax.ws.rs.Produces</span><span class="o">;</span><br/><br/><span class="c">/**</span><br/><span class="c"> *</span><br/><span class="c"> * @author mariano</span><br/><span class="c"> */</span><br/><span class="nd">@Path</span><span class="o">(</span><span class="s">"book"</span><span class="o">)</span><br/><span class="k">public</span> <span class="k">class</span> <span class="nc">AddressBook</span> <span class="o">{</span><br/><span class="k">private</span> <span class="k">static</span> <span class="n">addressbook</span><span class="o">.</span><span class="na">model</span><span class="o">.</span><span class="na">AddressBook</span> <span class="n">addressBook</span><span class="o">;</span><br/><br/><span class="k">public</span> <span class="k">static</span> <span class="n">addressbook</span><span class="o">.</span><span class="na">model</span><span class="o">.</span><span class="na">AddressBook</span> <span class="nf">search</span><span class="o">(</span><span class="n">String</span> <span class="n">type</span><span class="o">,</span> <span class="n">String</span> <span class="n">query</span><span class="o">)</span><br/><span class="o">{</span><br/><span class="k">if</span><span class="o">(</span><span class="n">type</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"firstName"</span><span class="o">))</span><br/><span class="o">{</span><br/><span class="k">return</span> <span class="k">new</span> <span class="n">addressbook</span><span class="o">.</span><span class="na">model</span><span class="o">.</span><span class="na">AddressBook</span><span class="o">(</span><span class="n">addressBook</span><span class="o">.</span><span class="na">searchByFirstName</span><span class="o">(</span><span class="n">query</span><span class="o">));</span><br/><span class="o">}</span><br/><span class="k">else</span> <span class="nf">if</span><span class="o">(</span><span class="n">type</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"lastName"</span><span class="o">))</span><br/><span class="o">{</span><br/><span class="k">return</span> <span class="k">new</span> <span class="n">addressbook</span><span class="o">.</span><span class="na">model</span><span class="o">.</span><span class="na">AddressBook</span><span class="o">(</span><span class="n">addressBook</span><span class="o">.</span><span class="na">searchByLastName</span><span class="o">(</span><span class="n">query</span><span class="o">));</span><br/><span class="o">}</span><br/><span class="k">else</span><br/><span class="o">{</span><br/><span class="k">return</span> <span class="k">new</span> <span class="n">addressbook</span><span class="o">.</span><span class="na">model</span><span class="o">.</span><span class="na">AddressBook</span><span class="o">(</span><span class="n">addressBook</span><span class="o">.</span><span class="na">search</span><span class="o">(</span><span class="n">query</span><span class="o">));</span><br/><span class="o">}</span><br/><span class="o">}</span><br/><br/><span class="k">public</span> <span class="k">static</span> <span class="n">addressbook</span><span class="o">.</span><span class="na">model</span><span class="o">.</span><span class="na">AddressBook</span> <span class="nf">getAddressBook</span><span class="o">()</span><br/><span class="o">{</span><br/><span class="k">if</span><span class="o">(</span><span class="n">addressBook</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span><br/><span class="n">addressBook</span> <span class="o">=</span> <span class="k">new</span> <span class="n">addressbook</span><span class="o">.</span><span class="na">model</span><span class="o">.</span><span class="na">AddressBook</span><span class="o">();</span><br/><br/><span class="k">return</span> <span class="n">addressBook</span><span class="o">;</span><br/><span class="o">}</span><br/><br/><span class="k">public</span> <span class="k">static</span> <span class="kt">void</span> <span class="nf">fill</span><span class="o">()</span><br/><span class="o">{</span><br/><span class="n">getAddressBook</span><span class="o">();</span><br/><span class="n">addressBook</span><span class="o">.</span><span class="na">addEntry</span><span class="o">(</span><span class="k">new</span> <span class="n">AddressBookEntry</span><span class="o">(</span><span class="s">"Bob"</span><span class="o">,</span> <span class="s">"Esponja"</span><span class="o">,</span> <span class="s">"Fondo de Bikini 1"</span><span class="o">,</span> <span class="s">"123"</span><span class="o">,</span> <span class="s">"321"</span><span class="o">,</span> <span class="s">"5551"</span><span class="o">));</span><br/><span class="n">addressBook</span><span class="o">.</span><span class="na">addEntry</span><span class="o">(</span><span class="k">new</span> <span class="n">AddressBookEntry</span><span class="o">(</span><span class="s">"Gary"</span><span class="o">,</span> <span class="s">"Caracol"</span><span class="o">,</span> <span class="s">"Fondo de Bikini 2"</span><span class="o">,</span> <span class="s">"234"</span><span class="o">,</span> <span class="s">"432"</span><span class="o">,</span> <span class="s">"5552"</span><span class="o">));</span><br/><span class="n">addressBook</span><span class="o">.</span><span class="na">addEntry</span><span class="o">(</span><span class="k">new</span> <span class="n">AddressBookEntry</span><span class="o">(</span><span class="s">"Arenita"</span><span class="o">,</span> <span class="s">"Ardilla"</span><span class="o">,</span> <span class="s">"Fondo de Bikini 3"</span><span class="o">,</span> <span class="s">"345"</span><span class="o">,</span> <span class="s">"543"</span><span class="o">,</span> <span class="s">"5553"</span><span class="o">));</span><br/><span class="n">addressBook</span><span class="o">.</span><span class="na">addEntry</span><span class="o">(</span><span class="k">new</span> <span class="n">AddressBookEntry</span><span class="o">(</span><span class="s">"Patricio"</span><span class="o">,</span> <span class="s">"Estrella"</span><span class="o">,</span> <span class="s">"Fondo de Bikini 4"</span><span class="o">,</span> <span class="s">"456"</span><span class="o">,</span> <span class="s">"654"</span><span class="o">,</span> <span class="s">"5554"</span><span class="o">));</span><br/><span class="n">addressBook</span><span class="o">.</span><span class="na">addEntry</span><span class="o">(</span><span class="k">new</span> <span class="n">AddressBookEntry</span><span class="o">(</span><span class="s">"Calamardo"</span><span class="o">,</span> <span class="s">"Calamar"</span><span class="o">,</span> <span class="s">"Fondo de Bikini 5"</span><span class="o">,</span> <span class="s">"567"</span><span class="o">,</span> <span class="s">"765"</span><span class="o">,</span> <span class="s">"5555"</span><span class="o">));</span><br/><span class="o">}</span><br/><br/><span class="nd">@GET</span><br/><span class="nd">@Path</span><span class="o">(</span><span class="s">"xml/all"</span><span class="o">)</span><br/><span class="nd">@Produces</span><span class="o">(</span><span class="s">"application/xml"</span><span class="o">)</span><br/><span class="k">public</span> <span class="k">static</span> <span class="n">addressbook</span><span class="o">.</span><span class="na">model</span><span class="o">.</span><span class="na">AddressBook</span> <span class="nf">getAllXml</span><span class="o">()</span><br/><span class="o">{</span><br/><span class="k">return</span> <span class="n">addressBook</span><span class="o">;</span><br/><span class="o">}</span><br/><br/><span class="nd">@GET</span><br/><span class="nd">@Path</span><span class="o">(</span><span class="s">"json/all"</span><span class="o">)</span><br/><span class="nd">@Produces</span><span class="o">(</span><span class="s">"application/json"</span><span class="o">)</span><br/><span class="k">public</span> <span class="k">static</span> <span class="n">addressbook</span><span class="o">.</span><span class="na">model</span><span class="o">.</span><span class="na">AddressBook</span> <span class="nf">getAllJson</span><span class="o">()</span><br/><span class="o">{</span><br/><span class="k">return</span> <span class="n">addressBook</span><span class="o">;</span><br/><span class="o">}</span><br/><br/><span class="nd">@GET</span><br/><span class="nd">@Path</span><span class="o">(</span><span class="s">"xml/search/{type}/{query}"</span><span class="o">)</span><br/><span class="nd">@Produces</span><span class="o">(</span><span class="s">"application/xml"</span><span class="o">)</span><br/><span class="k">public</span> <span class="k">static</span> <span class="n">addressbook</span><span class="o">.</span><span class="na">model</span><span class="o">.</span><span class="na">AddressBook</span> <span class="nf">searchXml</span><span class="o">(</span><span class="nd">@PathParam</span><span class="o">(</span><span class="s">"type"</span><span class="o">)</span> <span class="n">String</span> <span class="n">type</span><span class="o">,</span> <span class="nd">@PathParam</span><span class="o">(</span><span class="s">"query"</span><span class="o">)</span> <span class="n">String</span> <span class="n">query</span><span class="o">)</span><br/><span class="o">{</span><br/><span class="k">return</span> <span class="nf">search</span><span class="o">(</span><span class="n">type</span><span class="o">,</span> <span class="n">query</span><span class="o">);</span><br/><span class="o">}</span><br/><br/><span class="nd">@GET</span><br/><span class="nd">@Path</span><span class="o">(</span><span class="s">"json/search/{type}/{query}"</span><span class="o">)</span><br/><span class="nd">@Produces</span><span class="o">(</span><span class="s">"application/json"</span><span class="o">)</span><br/><span class="k">public</span> <span class="k">static</span> <span class="n">addressbook</span><span class="o">.</span><span class="na">model</span><span class="o">.</span><span class="na">AddressBook</span> <span class="nf">searchJson</span><span class="o">(</span><span class="nd">@PathParam</span><span class="o">(</span><span class="s">"type"</span><span class="o">)</span> <span class="n">String</span> <span class="n">type</span><span class="o">,</span> <span class="nd">@PathParam</span><span class="o">(</span><span class="s">"query"</span><span class="o">)</span> <span class="n">String</span> <span class="n">query</span><span class="o">)</span><br/><span class="o">{</span><br/><span class="k">return</span> <span class="nf">search</span><span class="o">(</span><span class="n">type</span><span class="o">,</span> <span class="n">query</span><span class="o">);</span><br/><span class="o">}</span><br/><span class="o">}</span><br/></pre></div><br/><br/>en el main agregue una linea antes de server.start(); en la que llamo a addressbook.ws.AddressBook.fill();<br/><br/>ahora con todo eso puesto, si corremos el ejemplo vamos a obtener resultados serializados, ejemplos de urls para probar los gets:<br/><br/>para obtener todos en xml:<br/><br/>http://0.0.0.0:9999/ws/book/xml/all<br/><br/>para obtener todos en json:<br/><br/>http://0.0.0.0:9999/ws/book/json/all<br/><br/>para buscar los que contienen en el nombre "ob" en xml:<br/><br/>http://0.0.0.0:9999/ws/book/xml/search/firstName/ob/<br/><br/>para buscar los que contienen en el apellido "a" en json:<br/><br/>http://0.0.0.0:9999/ws/book/json/search/lastName/a/<br/><br/>para buscar los que contienen en el nombre o apellido "e" en xml:<br/><br/>http://0.0.0.0:9999/ws/book/xml/search/all/e/<br/><br/>supongo que van entendiendo ;)<br/><br/>bueno, eso es todo por ahora en la proxima como escribir un modulo para javascript para consumir los webservices json y transformarlos en objetos y tambien como "dar de alta" nuevos AddressBookEntry.
<div style="clear: both;"/>
