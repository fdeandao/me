
Si leiste el post anterior y este podes empezar a formarte una idea de lo que quiero hacer.<br/><br/>para poder llamar codigo de C en erlang hay que hacer un NIF (native implemented functions), estoy siguiente el ejemplo del <a href="http://www.erlang.org/doc/man/erl_nif.html">manual de erlang</a> pero como tiene un error pongo el codigo aca.<br/><br/>creamos un archivo niftest.c y ponemos el siguiente codigo<br/><br/><div class="highlight"><pre><span class="cm">/* niftest.c */</span><br/><span class="cp">#include "erl_nif.h"</span><br/><span class="k">static</span> <span class="n">ERL_NIF_TERM</span> <span class="nf">hello</span><span class="p">(</span><span class="n">ErlNifEnv</span><span class="o">*</span> <span class="n">env</span><span class="p">,</span> <span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="n">ERL_NIF_TERM</span> <span class="n">argv</span><span class="p">[])</span><br/><span class="p">{</span><br/><span class="k">return</span> <span class="n">enif_make_string</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="s">"Hello world!"</span><span class="p">);</span><br/><span class="p">}</span><br/><span class="k">static</span> <span class="n">ErlNifFunc</span> <span class="n">nif_funcs</span><span class="p">[]</span> <span class="o">=</span><br/><span class="p">{</span><br/><span class="p">{</span><span class="s">"hello"</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">hello</span><span class="p">}</span><br/><span class="p">};</span><br/><span class="n">ERL_NIF_INIT</span><span class="p">(</span><span class="n">niftest</span><span class="p">,</span><span class="n">nif_funcs</span><span class="p">,</span><span class="nb">NULL</span><span class="p">,</span><span class="nb">NULL</span><span class="p">,</span><span class="nb">NULL</span><span class="p">,</span><span class="nb">NULL</span><span class="p">)</span><br/></pre></div><br/><br/><br/>creamos niftest.erl (tranquilamente se podria hacer en efene :D)<br/><br/><div class="highlight"><pre><span class="p">-</span><span class="ni">module</span><span class="p">(</span><span class="n">niftest</span><span class="p">).</span><br/><span class="p">-</span><span class="ni">export</span><span class="p">([</span><span class="n">init</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span> <span class="n">hello</span><span class="o">/</span><span class="mi">0</span><span class="p">]).</span><br/><span class="nf">init</span><span class="p">()</span> <span class="o">-&gt;</span><br/><span class="nn">erlang</span><span class="p">:</span><span class="n">load_nif</span><span class="p">(</span><span class="s">"./niftest"</span><span class="p">,</span> <span class="mi">0</span><span class="p">).</span><br/><span class="nf">hello</span><span class="p">()</span> <span class="o">-&gt;</span><br/><span class="s">"NIF library not loaded"</span><span class="p">.</span><br/></pre></div><br/><br/>compilamos<br/><br/><pre><br/>gcc -fPIC -shared -o niftest.so niftest.c -I/usr/lib/erlang/erts-5.7.4/include/<br/></pre><br/><br/>y lo probamos<br/><br/><pre><br/>$ erl<br/>cErlang R13B03 (erts-5.7.4) [source] [rq:1] [async-threads:0] [hipe] [kernel-poll:false]<br/><br/>Eshell V5.7.4  (abort with ^G)<br/>1&gt; c(niftest)<br/>1&gt; .<br/>{ok,niftest}<br/>2&gt; niftest:hello().<br/>"NIF library not loaded"<br/>3&gt; niftest:init().<br/>ok<br/>4&gt; niftest:hello().<br/>"Hello world!"<br/>5&gt;<br/></pre><br/><br/>vamos avanzando
<div style="clear: both;"/>
